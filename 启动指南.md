# 在线教育平台 - 启动指南

## 🎯 完整启动流程

### 第一步：启动后端服务器

打开PowerShell，切换到backend目录：

```powershell
cd backend
```

**选项A - 前台运行（推荐调试时使用）**：
```powershell
.\start-server.ps1
```
可以看到实时日志，按Ctrl+C停止

**选项B - 后台运行（推荐开发时使用）**：
```powershell
.\start-background.ps1
```
不占用终端，需要时运行 `.\stop-server.ps1` 停止

### 第二步：测试后端API

在backend目录运行：
```powershell
.\test-api.ps1
```

应该看到所有测试通过 ✅

### 第三步：启动前端开发服务器

打开**新的** PowerShell窗口，切换到frontend目录：

```powershell
cd frontend
npm run dev
```

前端会在 http://localhost:5173 启动（或其他端口，看终端输出）

### 第四步：访问应用

在浏览器打开：http://localhost:5173

## 📝 测试账号

| 角色 | 用户名 | 密码 |
|------|--------|------|
| 学生 | student | password123 |
| 教师 | instructor | password123 |
| 管理员 | admin | password123 |

## 🔧 常用命令

### 后端

```powershell
# 在backend目录下

# 启动服务器（前台）
.\start-server.ps1

# 启动服务器（后台）
.\start-background.ps1

# 停止后台服务器
.\stop-server.ps1

# 测试API
.\test-api.ps1

# 重新编译（修改代码后）
go build -o server.exe main.go
```

### 前端

```powershell
# 在frontend目录下

# 启动开发服务器
npm run dev

# 编译生产版本
npm run build

# 运行测试
npm run test
```

## 🌐 服务器地址

- **后端API**: http://localhost:8080/api/v1
- **健康检查**: http://localhost:8080/health
- **前端开发服务器**: http://localhost:5173 (Vite默认)

## 📊 功能测试清单

### ✅ 已实现的功能

#### 用户认证
- [x] 用户注册
- [x] 用户登录
- [x] 获取当前用户信息
- [x] 更新用户资料
- [x] 修改密码
- [x] 检查用户名/邮箱可用性

#### 课程管理
- [x] 获取课程列表（支持分页、筛选）
- [x] 创建课程（教师）
- [x] 获取课程详情
- [x] 更新课程（教师）
- [x] 删除课程（教师/管理员）
- [x] 学生选课
- [x] 获取课程章节
- [x] 创建章节（教师）

#### 作业管理
- [x] 获取作业列表
- [x] 创建作业（教师）
- [x] 获取作业详情
- [x] 提交作业（学生）
- [x] 获取提交列表
- [x] 批改作业（教师）

#### 考试管理
- [x] 获取考试列表
- [x] 创建考试（教师）
- [x] 获取考试详情
- [x] 添加题目（教师）
- [x] 提交答卷（学生）
- [x] 自动判分（客观题）
- [x] 获取成绩列表（教师）

#### 其他
- [x] 课程分类管理
- [x] JWT认证
- [x] 权限控制
- [x] CORS跨域支持

### 📹 视频播放说明

课程视频使用写死的测试视频URL：
- 测试视频：https://www.w3schools.com/html/mov_bbb.mp4

在生产环境中，可以替换为实际的视频地址（本地文件服务器或CDN）

### ❌ 未实现的功能（简化版本）

- [ ] 文件上传（头像、作业附件等）- 已简化
- [ ] 阿里云OSS集成 - 已简化为本地存储
- [ ] WebSocket实时聊天 - 已简化
- [ ] 直播推流 - 已简化为视频播放

## 🐛 故障排除

### 后端无法启动

**问题**: 端口被占用
```powershell
# 检查8080端口
netstat -ano | findstr :8080

# 停止占用进程（替换<PID>为实际进程ID）
taskkill /PID <PID> /F
```

**问题**: 数据库错误
```powershell
# 删除数据库文件重新生成
cd backend
Remove-Item database\education.db
.\start-server.ps1
```

### 前端无法连接后端

**问题**: CORS错误
- 确保后端已启动
- 检查 `frontend/.env` 文件中的API地址
- 确认后端CORS配置包含前端地址

**问题**: 401未授权错误
- 检查localStorage中的token是否有效
- 重新登录获取新token

### API测试失败

1. 确认后端服务器已启动：
   ```powershell
   Get-Process -Name "server"
   ```

2. 测试健康检查：
   ```powershell
   curl http://localhost:8080/health
   ```

3. 查看后端日志（如果是前台运行）

## 📚 目录结构

```
psychic-broccoli/
├── backend/                    # 后端代码
│   ├── server.exe             # 编译后的可执行文件
│   ├── start-server.ps1       # 启动脚本（前台）
│   ├── start-background.ps1   # 启动脚本（后台）
│   ├── stop-server.ps1        # 停止脚本
│   ├── test-api.ps1          # 测试脚本
│   ├── 使用说明.md            # 后端使用说明
│   ├── main.go               # 主程序
│   ├── config/               # 配置
│   ├── models/               # 数据模型
│   ├── database/             # 数据库
│   │   ├── schema.sql       # 建表SQL
│   │   ├── db.go            # 数据库连接
│   │   ├── seed.go          # 测试数据
│   │   └── education.db     # SQLite数据库文件
│   ├── handlers/             # API处理器
│   ├── middleware/           # 中间件
│   └── utils/                # 工具函数
├── frontend/                  # 前端代码
│   ├── src/                  # 源代码
│   ├── .env                  # 环境配置
│   └── package.json          # 依赖配置
├── document/                  # 项目文档
└── 启动指南.md               # 本文件
```

## 💡 开发技巧

### 1. 热重载开发

后端修改代码后需要重新编译：
```powershell
# 停止服务器
.\stop-server.ps1

# 重新编译
go build -o server.exe main.go

# 启动服务器
.\start-background.ps1
```

前端支持热重载，保存文件后自动刷新。

### 2. 数据库管理

使用SQLite客户端工具（如DB Browser for SQLite）打开：
```
backend/database/education.db
```

可以直接查看和修改数据。

### 3. 查看API文档

访问任意API端点会返回JSON格式的响应，包含：
- `code`: 状态码
- `message`: 消息
- `data`: 数据

### 4. 调试技巧

**后端调试**：
- 前台运行查看实时日志
- 在代码中添加 `fmt.Println()` 打印调试信息

**前端调试**：
- 使用浏览器开发者工具
- 查看Network面板的API请求
- 查看Console面板的错误信息

## 🎉 完成！

现在你可以：
1. ✅ 后端API服务器运行在 http://localhost:8080
2. ✅ 前端开发服务器运行在 http://localhost:5173
3. ✅ 使用测试账号登录系统
4. ✅ 测试各项功能

祝开发愉快！ 🚀

