# Week 3 交互功能测试指南

## 📊 测试数据概览

已成功导入以下测试数据：

- **5个直播会话** - 包含进行中、预定、已结束的不同状态
- **9条观看记录** - 展示学生加入/离开直播的行为
- **28条聊天消息** - 真实的师生互动对话
- **8个讨论主题** - 覆盖3门课程的技术讨论
- **54条讨论回复** - 丰富的问答和经验分享

## 🔐 测试账号

所有用户的密码都是：**password123**

### 学生账号
- `student` (ID: 1) - 已选课程11, 12
- `student2` (ID: 11) - 已选课程11, 13
- `student3` (ID: 12) - 已选课程12, 13
- `student4` (ID: 13) - 已选课程11

### 教师账号
- `instructor` (ID: 2) - Python和Java课程讲师
- `instructor2` (ID: 16) - 前端课程讲师

### 管理员账号
- `admin` (ID: 3) - 系统管理员

## 🎯 测试场景

### 1. 直播功能测试

#### 场景1：观看进行中的直播
1. **登录学生账号**：`student` / `password123`
2. **访问路径**：/student/courses → 选择"Python编程入门" → 点击"直播"标签
3. **预期结果**：
   - 看到"Python基础语法讲解"直播（进行中）
   - 显示15人在线
   - 可以点击进入观看

4. **进入直播间**：点击"观看直播"按钮
5. **预期功能**：
   - 显示播放器（虽然没有真实流，但界面应正常）
   - 显示实时观看人数
   - 右侧聊天室显示15条历史消息
   - 可以发送新消息

#### 场景2：查看历史直播
1. **切换到"已结束"标签**
2. **预期结果**：
   - 看到"Python函数与模块"（2月5日）
   - 看到"CSS Flexbox布局实战"（2月4日）
   - 显示观看人数和时长

#### 场景3：教师创建直播
1. **登录教师账号**：`instructor` / `password123`
2. **访问路径**：/teacher/live
3. **预期结果**：
   - 看到自己创建的所有直播列表
   - 可以创建新直播
   - 可以管理现有直播

4. **创建新直播**：
   - 选择课程："Java高级编程"
   - 输入标题："Spring Boot微服务架构"
   - 输入描述："讲解微服务架构设计和实现"
   - 选择时间：2026-02-09 14:00:00

5. **预期结果**：
   - 成功创建直播
   - 获得推流地址和播放地址
   - 状态为"SCHEDULED"

#### 场景4：开始直播
1. **选择一个预定的直播**："Java并发编程实战"
2. **点击"开始直播"按钮**
3. **预期结果**：
   - 状态变更为"LIVE"
   - 显示推流地址（用于OBS推流）
   - 可以看到聊天室

### 2. 聊天功能测试

#### 场景1：实时聊天
1. **学生登录并进入进行中的直播**
2. **发送消息**：输入"老师讲得很清楚！"
3. **预期结果**：
   - 消息立即显示在聊天列表
   - 显示发送者头像和用户名
   - 显示发送时间
   - 自动滚动到最新消息

4. **多个学生同时聊天**：
   - 打开多个浏览器窗口，分别登录不同学生账号
   - 各自发送消息
   - 验证所有窗口都能看到新消息（2秒轮询）

#### 场景2：教师管理聊天
1. **教师登录并进入自己的直播**
2. **查看聊天消息**：看到学生的所有提问
3. **删除不当消息**：点击消息旁的"删除"按钮
4. **预期结果**：
   - 消息被删除
   - 所有观看者界面上消息也消失

#### 场景3：历史消息查看
1. **进入已结束的直播**："Python函数与模块"
2. **预期结果**：
   - 显示7条历史聊天记录
   - 无法发送新消息（直播已结束）
   - 可以查看完整的讨论内容

### 3. 讨论区功能测试

#### 场景1：浏览讨论列表
1. **登录学生账号**：`student` / `password123`
2. **访问路径**：/student/discussions
3. **预期结果**：
   - 看到8个讨论主题
   - 显示标题、课程、发起人、回复数
   - 显示状态标签（进行中/已关闭）

4. **筛选功能**：
   - 按课程筛选："Python编程入门"
   - 按状态筛选："进行中"
   - 搜索关键词："线程池"

#### 场景2：查看讨论详情
1. **点击讨论**："Java线程池的最佳实践讨论"
2. **预期结果**：
   - 显示完整的讨论内容
   - 显示12条回复
   - 每条回复显示用户头像、用户名、发布时间
   - 包含老师和同学的技术讨论

3. **滚动查看**：
   - 可以看到多轮讨论
   - 有技术问题、解答、补充说明
   - 形成完整的知识交流

#### 场景3：发起新讨论
1. **点击"发起讨论"按钮**
2. **填写表单**：
   - 选择课程："Python编程入门"
   - 输入标题："装饰器的实际应用场景"
   - 输入内容："请问装饰器在实际项目中有哪些常见的使用场景？能否分享一些案例？"

3. **提交讨论**
4. **预期结果**：
   - 讨论创建成功
   - 跳转到讨论详情页
   - 显示"0条回复"
   - 状态为"进行中"

#### 场景4：回复讨论
1. **进入任意讨论**："列表推导式的使用技巧分享"
2. **滚动到底部回复区**
3. **输入回复**："我也分享一个技巧：可以用条件表达式增加灵活性 [x if x > 0 else 0 for x in data]"
4. **点击"发表回复"**
5. **预期结果**：
   - 回复立即显示
   - 回复数量+1
   - 自动滚动到新回复位置

#### 场景5：关闭讨论
1. **登录讨论发起者或教师账号**
2. **进入自己发起的讨论**
3. **点击"关闭讨论"按钮**
4. **确认关闭**
5. **预期结果**：
   - 讨论状态变为"已关闭"
   - 无法继续回复
   - 仍可查看历史内容

#### 场景6：删除讨论
1. **登录讨论发起者账号**：`student` / `password123`
2. **进入自己的讨论**："第一次作业提交问题（已解决）"
3. **点击"删除"按钮**
4. **确认删除**
5. **预期结果**：
   - 讨论被删除
   - 跳转回讨论列表
   - 该讨论不再显示

### 4. 权限测试

#### 场景1：未选课学生访问
1. **登录**：`student5` / `password123` (未选任何课程)
2. **尝试访问**：直播、讨论区
3. **预期结果**：
   - 看不到任何课程的直播
   - 无法发起讨论
   - 无法回复讨论
   - 提示"您未选修此课程"

#### 场景2：学生越权操作
1. **登录普通学生账号**
2. **尝试删除他人的讨论**
3. **预期结果**：
   - 没有删除按钮
   - API返回403权限错误

#### 场景3：教师权限
1. **登录教师账号**：`instructor` / `password123`
2. **验证权限**：
   - 可以创建直播
   - 可以开始/结束直播
   - 可以删除聊天消息
   - 可以关闭任意讨论
   - 无法删除学生发起的讨论（除非是自己课程的）

#### 场景4：管理员权限
1. **登录管理员账号**：`admin` / `password123`
2. **验证权限**：
   - 拥有所有功能的完全访问权限
   - 可以管理所有直播
   - 可以删除任意讨论
   - 可以查看所有数据

## 🐛 可能遇到的问题

### 问题1：直播播放器显示黑屏
**原因**：测试环境没有配置真实的流媒体服务器
**说明**：这是正常的，因为我们只是测试界面和交互功能，没有实际的RTMP推流
**验证重点**：聊天功能、观看人数统计、直播状态管理

### 问题2：聊天消息不实时更新
**原因**：使用HTTP轮询，延迟为2秒
**说明**：这是设计如此，避免WebSocket部署复杂性
**验证方法**：等待2-3秒后消息会自动出现

### 问题3：头像不显示
**原因**：使用的是 pravatar.cc 在线头像服务
**说明**：需要网络连接才能加载头像图片
**解决方法**：检查网络连接，或者图片加载失败不影响功能测试

## ✅ 测试检查清单

### 直播功能
- [ ] 查看直播列表
- [ ] 进入直播间
- [ ] 观看人数统计正确
- [ ] 教师创建直播
- [ ] 教师开始/结束直播
- [ ] 学生加入/离开直播

### 聊天功能
- [ ] 发送消息
- [ ] 接收消息（2秒轮询）
- [ ] 显示用户信息
- [ ] 消息自动滚动
- [ ] 教师删除消息
- [ ] 历史消息查看

### 讨论区功能
- [ ] 浏览讨论列表
- [ ] 筛选和搜索
- [ ] 查看讨论详情
- [ ] 发起新讨论
- [ ] 回复讨论
- [ ] 关闭讨论
- [ ] 删除讨论
- [ ] 回复数统计正确

### 权限验证
- [ ] 未选课学生无法参与
- [ ] 学生无法越权操作
- [ ] 教师权限正确
- [ ] 管理员权限正确

## 📝 测试报告模板

测试完成后，可以填写以下报告：

```markdown
## Week 3 功能测试报告

**测试时间**：2026-02-06
**测试人员**：[你的名字]
**后端版本**：最新版
**前端版本**：最新版

### 测试结果

#### 1. 直播功能
- 创建直播：✅ / ❌
- 开始直播：✅ / ❌
- 观看直播：✅ / ❌
- 观众统计：✅ / ❌

#### 2. 聊天功能
- 发送消息：✅ / ❌
- 接收消息：✅ / ❌
- 删除消息：✅ / ❌
- 历史记录：✅ / ❌

#### 3. 讨论区功能
- 创建讨论：✅ / ❌
- 回复讨论：✅ / ❌
- 关闭讨论：✅ / ❌
- 删除讨论：✅ / ❌

#### 4. 发现的问题
1. [描述问题]
2. [描述问题]

#### 5. 改进建议
1. [建议内容]
2. [建议内容]
```

## 🚀 快速开始

1. **启动服务**：
   - 后端：已在 Docker 中运行 (http://localhost:8080)
   - 前端：应该在另一个终端运行 (http://localhost:5173)

2. **登录账号**：student / password123

3. **开始测试**：
   - 导航到"我的课程"
   - 进入"Python编程入门"
   - 查看"直播"和"讨论"标签

4. **探索功能**：
   - 观看进行中的直播
   - 在聊天室发送消息
   - 浏览讨论主题
   - 发起新的讨论

祝测试顺利！🎉
