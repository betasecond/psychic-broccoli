# ğŸ‰ æ–°åŠŸèƒ½è¯´æ˜

## å¦‚ä½•æ›´æ–°åç«¯

åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```powershell
.\update-backend.ps1
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. âœ… åœæ­¢æ—§çš„æœåŠ¡å™¨
2. âœ… å®‰è£…Excelå¤„ç†åº“
3. âœ… é‡æ–°ç¼–è¯‘
4. âœ… å¯åŠ¨æ–°æœåŠ¡å™¨

## âœ¨ æ–°å¢åŠŸèƒ½åˆ—è¡¨

### 1ï¸âƒ£ ä½œä¸šç®¡ç† - å®Œæ•´CRUD

| æ“ä½œ | æ–¹æ³• | ç«¯ç‚¹ | æƒé™ |
|------|------|------|------|
| åˆ›å»º | POST | `/api/v1/assignments` | æ•™å¸ˆ/ç®¡ç†å‘˜ |
| è¯»å–åˆ—è¡¨ | GET | `/api/v1/assignments` | è®¤è¯ç”¨æˆ· |
| è¯»å–è¯¦æƒ… | GET | `/api/v1/assignments/:id` | è®¤è¯ç”¨æˆ· |
| **æ›´æ–°** | **PUT** | **`/api/v1/assignments/:id`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |
| **åˆ é™¤** | **DELETE** | **`/api/v1/assignments/:id`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |

### 2ï¸âƒ£ è€ƒè¯•ç®¡ç† - å®Œæ•´CRUD

| æ“ä½œ | æ–¹æ³• | ç«¯ç‚¹ | æƒé™ |
|------|------|------|------|
| åˆ›å»ºè€ƒè¯• | POST | `/api/v1/exams` | æ•™å¸ˆ/ç®¡ç†å‘˜ |
| è¯»å–è€ƒè¯•åˆ—è¡¨ | GET | `/api/v1/exams` | è®¤è¯ç”¨æˆ· |
| è¯»å–è€ƒè¯•è¯¦æƒ… | GET | `/api/v1/exams/:id` | è®¤è¯ç”¨æˆ· |
| **æ›´æ–°è€ƒè¯•** | **PUT** | **`/api/v1/exams/:id`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |
| **åˆ é™¤è€ƒè¯•** | **DELETE** | **`/api/v1/exams/:id`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |
| æ·»åŠ é¢˜ç›® | POST | `/api/v1/exams/:id/questions` | æ•™å¸ˆ/ç®¡ç†å‘˜ |
| **æ›´æ–°é¢˜ç›®** | **PUT** | **`/api/v1/exams/:id/questions/:qid`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |
| **åˆ é™¤é¢˜ç›®** | **DELETE** | **`/api/v1/exams/:id/questions/:qid`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |

### 3ï¸âƒ£ ç« èŠ‚ç®¡ç† - å®Œæ•´CRUD

| æ“ä½œ | æ–¹æ³• | ç«¯ç‚¹ | æƒé™ |
|------|------|------|------|
| åˆ›å»ºç« èŠ‚ | POST | `/api/v1/courses/:id/chapters` | æ•™å¸ˆ/ç®¡ç†å‘˜ |
| è¯»å–ç« èŠ‚åˆ—è¡¨ | GET | `/api/v1/courses/:id/chapters` | æ‰€æœ‰ç”¨æˆ· |
| **æ›´æ–°ç« èŠ‚** | **PUT** | **`/api/v1/courses/:id/chapters/:cid`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |
| **åˆ é™¤ç« èŠ‚** | **DELETE** | **`/api/v1/courses/:id/chapters/:cid`** | **æ•™å¸ˆ/ç®¡ç†å‘˜** |

### 4ï¸âƒ£ ç”¨æˆ·æ‰¹é‡å¯¼å…¥ï¼ˆExcelï¼‰â­ å…¨æ–°åŠŸèƒ½

| æ“ä½œ | æ–¹æ³• | ç«¯ç‚¹ | æƒé™ |
|------|------|------|------|
| **æ‰¹é‡å¯¼å…¥ç”¨æˆ·** | **POST** | **`/api/v1/auth/import-users`** | **ç®¡ç†å‘˜** |
| **ä¸‹è½½å¯¼å…¥æ¨¡æ¿** | **GET** | **`/api/v1/auth/user-template`** | **ç®¡ç†å‘˜** |

## ğŸ“¥ Excelæ‰¹é‡å¯¼å…¥ç”¨æˆ·ä½¿ç”¨æŒ‡å—

### æ­¥éª¤1: ä¸‹è½½æ¨¡æ¿

**æ–¹æ³•A - æµè§ˆå™¨ä¸‹è½½**ï¼š
1. ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ç³»ç»Ÿ
2. è®¿é—®ï¼š`http://localhost:8080/api/v1/auth/user-template`
3. è‡ªåŠ¨ä¸‹è½½ `user_import_template.xlsx`

**æ–¹æ³•B - å‰ç«¯ä»£ç è°ƒç”¨**ï¼š
```typescript
import { userService } from '@/services/userService'

// ä¸‹è½½æ¨¡æ¿
await userService.triggerDownloadTemplate()
```

### æ­¥éª¤2: å¡«å†™Excelè¡¨æ ¼

æ¨¡æ¿åŒ…å«ä»¥ä¸‹åˆ—ï¼š

| åˆ—å | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| ç”¨æˆ·å | âœ… | å”¯ä¸€ï¼Œä¸èƒ½é‡å¤ | student01 |
| å¯†ç  | âœ… | æ˜æ–‡å¯†ç ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŠ å¯† | password123 |
| è§’è‰² | âœ… | STUDENT/INSTRUCTOR/ADMIN | STUDENT |
| é‚®ç®± | âŒ | å¯é€‰ | student01@example.com |
| å¤´åƒURL | âŒ | å¯é€‰ | https://i.pravatar.cc/150?u=student01 |

**ç¤ºä¾‹æ•°æ®**ï¼š
```
ç”¨æˆ·å      å¯†ç           è§’è‰²         é‚®ç®±                    å¤´åƒURL
student01   password123   STUDENT      student01@example.com   https://...
teacher01   password123   INSTRUCTOR   teacher01@example.com   https://...
admin01     password123   ADMIN        admin01@example.com     https://...
```

### æ­¥éª¤3: ä¸Šä¼ Excelæ–‡ä»¶

**å‰ç«¯ä»£ç ç¤ºä¾‹**ï¼š
```typescript
import { userService } from '@/services/userService'

// å¤„ç†æ–‡ä»¶ä¸Šä¼ 
const handleFileUpload = async (file: File) => {
  try {
    const result = await userService.importUsersFromExcel(file)
    console.log('å¯¼å…¥ç»“æœ:', result)
    // {
    //   successCount: 10,
    //   errorCount: 2,
    //   errors: ["ç¬¬3è¡Œ: ç”¨æˆ·åå·²å­˜åœ¨", ...],
    //   message: "æˆåŠŸå¯¼å…¥10ä¸ªç”¨æˆ·ï¼Œå¤±è´¥2ä¸ª"
    // }
  } catch (error) {
    console.error('å¯¼å…¥å¤±è´¥:', error)
  }
}

// åœ¨Ant Design Uploadç»„ä»¶ä¸­ä½¿ç”¨
<Upload
  beforeUpload={(file) => {
    handleFileUpload(file)
    return false // é˜»æ­¢è‡ªåŠ¨ä¸Šä¼ 
  }}
  accept=".xlsx,.xls"
>
  <Button icon={<UploadOutlined />}>æ‰¹é‡å¯¼å…¥ç”¨æˆ·</Button>
</Upload>
```

### æ­¥éª¤4: æŸ¥çœ‹å¯¼å…¥ç»“æœ

ç³»ç»Ÿä¼šè¿”å›ï¼š
- `successCount`: æˆåŠŸå¯¼å…¥çš„ç”¨æˆ·æ•°
- `errorCount`: å¤±è´¥çš„è®°å½•æ•°
- `errors`: å¤±è´¥åŸå› åˆ—è¡¨ï¼ˆåŒ…å«è¡Œå·ï¼‰
- `message`: æ±‡æ€»ä¿¡æ¯

## ğŸ§ª æµ‹è¯•æ–°åŠŸèƒ½

è¿è¡Œæµ‹è¯•è„šæœ¬ï¼š

```powershell
cd backend
.\test-new-features.ps1
```

è¿™ä¼šæµ‹è¯•ï¼š
- âœ… æ›´æ–°ä½œä¸š
- âœ… æ›´æ–°è€ƒè¯•
- âœ… æ›´æ–°ç« èŠ‚
- âœ… ä¸‹è½½å¯¼å…¥æ¨¡æ¿æç¤º

## ğŸ“ å‰ç«¯é›†æˆç¤ºä¾‹

### å¯¼å…¥userService

```typescript
import { userService } from '@/services/userService'
```

### ä¸‹è½½æ¨¡æ¿

```typescript
const handleDownloadTemplate = async () => {
  try {
    await userService.triggerDownloadTemplate()
    message.success('æ¨¡æ¿ä¸‹è½½æˆåŠŸ')
  } catch (error) {
    message.error('æ¨¡æ¿ä¸‹è½½å¤±è´¥')
  }
}
```

### æ‰¹é‡å¯¼å…¥

```typescript
const handleImport = async (file: File) => {
  try {
    const result = await userService.importUsersFromExcel(file)
    
    if (result.errorCount > 0) {
      // æ˜¾ç¤ºé”™è¯¯è¯¦æƒ…
      Modal.warning({
        title: `å¯¼å…¥å®Œæˆï¼ˆæˆåŠŸ${result.successCount}ä¸ªï¼Œå¤±è´¥${result.errorCount}ä¸ªï¼‰`,
        content: (
          <div>
            {result.errors.map((err, index) => (
              <div key={index}>{err}</div>
            ))}
          </div>
        ),
      })
    } else {
      message.success(result.message)
    }
  } catch (error) {
    message.error('å¯¼å…¥å¤±è´¥')
  }
}
```

### å®Œæ•´ç»„ä»¶ç¤ºä¾‹

```typescript
import { Upload, Button, Modal, message } from 'antd'
import { UploadOutlined, DownloadOutlined } from '@ant-design/icons'
import { userService } from '@/services/userService'

const UserImportPage = () => {
  const handleDownloadTemplate = async () => {
    await userService.triggerDownloadTemplate()
    message.success('æ¨¡æ¿ä¸‹è½½æˆåŠŸ')
  }

  const handleFileUpload = async (file: File) => {
    const result = await userService.importUsersFromExcel(file)
    
    if (result.errorCount > 0) {
      Modal.warning({
        title: `å¯¼å…¥ç»“æœ`,
        content: (
          <div>
            <p>æˆåŠŸ: {result.successCount} ä¸ª</p>
            <p>å¤±è´¥: {result.errorCount} ä¸ª</p>
            <div style={{ maxHeight: 200, overflow: 'auto' }}>
              {result.errors.map((err, i) => <div key={i}>{err}</div>)}
            </div>
          </div>
        ),
      })
    } else {
      message.success(result.message)
    }
  }

  return (
    <div>
      <Button 
        icon={<DownloadOutlined />} 
        onClick={handleDownloadTemplate}
        style={{ marginRight: 16 }}
      >
        ä¸‹è½½å¯¼å…¥æ¨¡æ¿
      </Button>
      
      <Upload
        beforeUpload={(file) => {
          handleFileUpload(file)
          return false
        }}
        accept=".xlsx,.xls"
        showUploadList={false}
      >
        <Button icon={<UploadOutlined />}>
          æ‰¹é‡å¯¼å…¥ç”¨æˆ·
        </Button>
      </Upload>
    </div>
  )
}
```

## ğŸ¯ CRUDåŠŸèƒ½å¯¹æ¯”

### æ›´æ–°å‰ âŒ
- ä½œä¸šï¼šåªèƒ½åˆ›å»ºã€æŸ¥çœ‹ï¼Œ**ä¸èƒ½ä¿®æ”¹ã€åˆ é™¤**
- è€ƒè¯•ï¼šåªèƒ½åˆ›å»ºã€æŸ¥çœ‹ï¼Œ**ä¸èƒ½ä¿®æ”¹ã€åˆ é™¤**
- é¢˜ç›®ï¼šåªèƒ½æ·»åŠ ï¼Œ**ä¸èƒ½ä¿®æ”¹ã€åˆ é™¤**
- ç« èŠ‚ï¼šåªèƒ½åˆ›å»ºã€æŸ¥çœ‹ï¼Œ**ä¸èƒ½ä¿®æ”¹ã€åˆ é™¤**
- ç”¨æˆ·ï¼š**åªèƒ½å•ä¸ªæ³¨å†Œ**

### æ›´æ–°å âœ…
- ä½œä¸šï¼šâœ… å®Œæ•´CRUDï¼ˆåˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ï¼‰
- è€ƒè¯•ï¼šâœ… å®Œæ•´CRUD
- é¢˜ç›®ï¼šâœ… å®Œæ•´CRUD
- ç« èŠ‚ï¼šâœ… å®Œæ•´CRUD
- ç”¨æˆ·ï¼šâœ… æ”¯æŒExcelæ‰¹é‡å¯¼å…¥

## ğŸ“š APIæ–‡æ¡£æ›´æ–°

å®Œæ•´çš„APIæ–‡æ¡£è¯·æŸ¥çœ‹ `backend/ä½¿ç”¨è¯´æ˜.md`

æ–°å¢ç«¯ç‚¹å·²è‡ªåŠ¨é›†æˆåˆ°åç«¯ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼

## ğŸš€ å¼€å§‹ä½¿ç”¨

1. **æ›´æ–°åç«¯**ï¼š
   ```powershell
   .\update-backend.ps1
   ```

2. **æµ‹è¯•åŠŸèƒ½**ï¼š
   ```powershell
   cd backend
   .\test-new-features.ps1
   ```

3. **å‰ç«¯é›†æˆ**ï¼š
   ä½¿ç”¨ `frontend/src/services/userService.ts` è°ƒç”¨æ–°API

ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰

